window.onload = function() {
    let e = document.getElementById("hamburger")
      , t = document.getElementById("nav")
      , r = !1;
    e.addEventListener("click", function() {
        e.classList.toggle("hamburger--active"),
        header.classList.toggle("header--active"),
        t.classList.toggle("nav--active"),
        document.body.classList.toggle("body--hidden"),
        r = !r
    }),
    window.addEventListener("scroll", function e() {
        let t = document.getElementById("header");
        this.scrollY >= 1 ? t.classList.add("header--scroll") : t.classList.remove("header--scroll")
    });
    let o = document.querySelectorAll(".request-form__page")
      , a = document.querySelectorAll(".button--rf-next")
      , l = document.querySelectorAll(".button--rf-prev")
      , s = document.querySelector("#rf-submit")
      , n = document.querySelectorAll(".request-form__input._number")
      , i = document.querySelector("#rf-v-year")
      , c = document.querySelector("#rf-v-make")
      , u = document.querySelector("#rf-v-model")
      , d = document.querySelector("#rf-v-size-class");
    function f(e) {
        e.closest(".request-form__group").classList.add("_error")
    }
    function v(e, t) {
        return e.forEach(e => {
            var r;
            (function e(t) {
                t.closest(".request-form__group").classList.remove("_error")
            }
            )(e),
            "" === e.value && (f(e),
            t++),
            "email" === e.getAttribute("type") && (r = e,
            !/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,8})+$/.test(r.value)) && (f(e),
            t++),
            "tel" === e.getAttribute("type") && !(/^(\s*)?(\+)?([- _():=+]?\d[- _():=+]?){10,14}(\s*)?$/.test(e.value) && 18 == e.value.length) && (f(e),
            t++)
        }
        ),
        t
    }
    if (a && a.forEach(e => {
        e.addEventListener("click", function(t) {
            t.preventDefault();
            let r = 0
              , a = e.closest(".request-form__page");
            if (0 === (r = v(a.querySelectorAll("._req"), r))) {
                var l;
                let s = Array.from(o).findIndex(e => e.classList.contains("request-form__page--active"));
                l = s,
                o[l].classList.remove("request-form__page--active"),
                o[l + 1].classList.add("request-form__page--active")
            }
        })
    }
    ),
    l && l.forEach(e => {
        e.addEventListener("click", function(e) {
            var t;
            e.preventDefault();
            let r = Array.from(o).findIndex(e => e.classList.contains("request-form__page--active"));
            t = r,
            o[t].classList.remove("request-form__page--active"),
            o[t - 1].classList.add("request-form__page--active")
        })
    }
    ),
    s && (document.querySelector("#request-form").addEventListener("submit", function(e) {
        e.preventDefault()
    }),
    s.addEventListener("click", function(e) {
        e.preventDefault();
        let t = 0
          , r = s.closest(".request-form__page");
        if (0 === (t = v(r.querySelectorAll("._req"), t))) {
            let o = {
                method: "POST",
                headers: {
                    "X-CSRF-Token": $("meta[name=csrf-token]").attr("content")
                },
                body: JSON.stringify({
                    zc_from: document.querySelector("#rf-zc-from").value,
                    zc_to: document.querySelector("#rf-zc-to").value,
                    date: document.querySelector("#rf-date").value,
                    condition: document.querySelector("#rf-condition").value,
                    v_year: document.querySelector("#rf-v-year").value,
                    v_make: document.querySelector("#rf-v-make").value,
                    v_model: document.querySelector("#rf-v-model").value,
                    v_size_class: document.querySelector("#rf-v-size-class").value,
                    first_name: document.querySelector("#rf-first-name").value,
                    last_name: document.querySelector("#rf-last-name").value,
                    email: document.querySelector("#rf-email").value,
                    phone: document.querySelector("#rf-phone").value
                })
            };
            fetch("/site/submit-request-form", o).then(e => {
                if (e.ok)
                    return document.body.classList.add("body--sending"),
                    e.text();
                throw Error("Network response was not ok.")
            }
            ).then(e => {
                "Success." === e && (document.body.classList.remove("body--sending"),
                window.location.href = "/site/thank-you")
            }
            ).catch(e => {
                console.error("Error submitting info: ", e)
            }
            ),
            console.log("Sent!")
        }
    })),
    [].forEach.call(document.querySelectorAll("._tel"), function(e) {
        var t;
        function r(e) {
            e.keyCode && (t = e.keyCode),
            this.selectionStart < 3 && e.preventDefault();
            var r = "+1 (___) ___-__-__"
              , o = 0
              , a = r.replace(/\D/g, "")
              , l = this.value.replace(/\D/g, "")
              , s = r.replace(/[_\d]/g, function(e) {
                return o < l.length ? l.charAt(o++) || a.charAt(o) : e
            });
            -1 != (o = s.indexOf("_")) && (o < 5 && (o = 3),
            s = s.slice(0, o));
            var n = r.substr(0, this.value.length).replace(/_+/g, function(e) {
                return "\\d{1," + e.length + "}"
            }).replace(/[+()]/g, "\\$&");
            (!(n = RegExp("^" + n + "$")).test(this.value) || this.value.length < 5 || t > 47 && t < 58) && (this.value = s),
            "blur" == e.type && this.value.length < 5 && (this.value = "")
        }
        e.addEventListener("input", r, !1),
        e.addEventListener("focus", r, !1),
        e.addEventListener("blur", r, !1),
        e.addEventListener("keydown", r, !1)
    }),
    n && n.forEach(e => {
        e.addEventListener("input", function() {
            e.value = e.value.replace(/[^0-9]/g, "")
        })
    }
    ),
    document.querySelector("#rf-date")) {
        var h;
        document.querySelector("#rf-date").readOnly = !0,
        new Datepicker("#rf-date",{
            min: ((h = new Date).setDate(h.getDate() - 1),
            h)
        })
    }
    function m(e, t, r) {
        e.innerHTML = "";
        let o = document.createElement("option");
        for (let a of (o.value = "",
        o.textContent = r,
        e.appendChild(o),
        t)) {
            let l = document.createElement("option");
            l.value = a,
            l.textContent = a,
            e.appendChild(l)
        }
        e.disabled = !1
    }
    i && i.addEventListener("change", function() {
        let e = i.value;
        if ("" !== e) {
            let t = {
                method: "POST",
                headers: {
                    "Content-Type": "application/json;charset=utf-8",
                    "X-CSRF-Token": $("meta[name=csrf-token]").attr("content")
                },
                body: JSON.stringify({
                    year: e
                })
            };
            fetch("/vehicle/get-makes", t).then(e => {
                if (e.ok)
                    return e.text();
                throw Error("Network response was not ok.")
            }
            ).then(e => {
                m(c, JSON.parse(e), "Choose Vehicle Make"),
                m(u, [], "Choose Vehicle Model"),
                u.disabled = !0,
                m(d, [], "Choose Size Class"),
                d.disabled = !0
            }
            ).catch(e => {
                console.error("Error submitting info: ", e)
            }
            )
        } else
            m(c, [], "Choose Vehicle Make"),
            c.disabled = !0,
            m(u, [], "Choose Vehicle Model"),
            u.disabled = !0,
            m(d, [], "Choose Size Class"),
            d.disabled = !0
    }),
    c && c.addEventListener("change", function() {
        let e = i.value
          , t = c.value;
        if ("" !== t) {
            let r = {
                method: "POST",
                headers: {
                    "Content-Type": "application/json;charset=utf-8",
                    "X-CSRF-Token": $("meta[name=csrf-token]").attr("content")
                },
                body: JSON.stringify({
                    year: e,
                    make: t
                })
            };
            fetch("/vehicle/get-models", r).then(e => {
                if (e.ok)
                    return e.text();
                throw Error("Network response was not ok.")
            }
            ).then(e => {
                m(u, JSON.parse(e), "Choose Vehicle Model"),
                m(d, [], "Choose Size Class"),
                d.disabled = !0
            }
            ).catch(e => {
                console.error("Error submitting info: ", e)
            }
            )
        } else
            m(u, [], "Choose Vehicle Model"),
            u.disabled = !0,
            m(d, [], "Choose Size Class"),
            d.disabled = !0
    }),
    u && u.addEventListener("change", function() {
        let e = i.value
          , t = c.value
          , r = u.value;
        if ("" !== r) {
            let o = {
                method: "POST",
                headers: {
                    "Content-Type": "application/json;charset=utf-8",
                    "X-CSRF-Token": $("meta[name=csrf-token]").attr("content")
                },
                body: JSON.stringify({
                    year: e,
                    make: t,
                    model: r
                })
            };
            fetch("/vehicle/get-size-class", o).then(e => {
                if (e.ok)
                    return e.text();
                throw Error("Network response was not ok.")
            }
            ).then(e => {
                m(d, JSON.parse(e), "Choose Size Class")
            }
            ).catch(e => {
                console.error("Error submitting info: ", e)
            }
            )
        } else
            m(d, [], "Choose Size Class"),
            d.disabled = !0
    })
}
;
